version: 1
backend:
  phases:
    preBuild:
      commands:
        - echo "Installing Python dependencies..."
        - pip install -r requirements.txt
    build:
      commands:
        - echo "Backend build step is not needed for Flask."
  start:
    commands:
      - echo "Starting backend server..."
      - chmod +x run_gunicorn.sh
      - ./run_gunicorn.sh
frontend:
  phases:
    preBuild:
      commands:
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: dist
    files:
      - "**/*"
  cache:
    paths:
      - node_modules/**/*
  customRules:
    - source: "/api/<*>
      target: "http://localhost:8080/api/<*>"
      status: 200
      condition: null
    - source: "/<*>
      target: "/index.html"
      status: 200
      condition: null
